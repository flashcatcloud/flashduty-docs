---
title: é€šçŸ¥æ¨¡æ¿
description: é€šçŸ¥æ¨¡æ¿ç”¨äºæ§åˆ¶æ•…éšœé€šçŸ¥çš„å†…å®¹æ ¼å¼ï¼Œç³»ç»Ÿåœ¨åˆ†æ´¾æ•…éšœæ—¶ï¼Œä½¿ç”¨æ¨¡æ¿æ¸²æŸ“æ•…éšœä¿¡æ¯å¹¶å‘é€é€šçŸ¥ã€‚
keywords: ["é€šçŸ¥æ¨¡æ¿", "æ¨¡æ¿é…ç½®", "æ¶ˆæ¯æ ¼å¼", "æ¨¡æ¿å˜é‡", "é€šçŸ¥å†…å®¹"]

---

## ä½¿ç”¨åœºæ™¯

ç³»ç»Ÿåœ¨ä»¥ä¸‹åœºæ™¯åˆ†æ´¾æ•…éšœæ—¶ä¼šä½¿ç”¨æ¨¡æ¿ï¼š

| åœºæ™¯ | è¯´æ˜ |
| :--- | :--- |
| æ‰‹åŠ¨åˆ›å»ºæ•…éšœ | æ‰‹åŠ¨åˆ›å»ºæ•…éšœå¹¶åˆ†æ´¾ |
| è‡ªåŠ¨ç”Ÿæˆæ•…éšœ | ä¸ŠæŠ¥å‘Šè­¦äº‹ä»¶ï¼Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆæ•…éšœï¼ŒæŒ‰åŒ¹é…åˆ°çš„åˆ†æ´¾ç­–ç•¥è¿›è¡Œåˆ†æ´¾ |
| é‡æ–°åˆ†æ´¾ | æ•…éšœåˆ›å»ºåï¼Œæ‰‹åŠ¨æ›´æ”¹åˆ†æ´¾ |
| å‡çº§åˆ†æ´¾ | æ ¹æ®åˆ†æ´¾ç­–ç•¥è®¾ç½®ï¼Œç³»ç»Ÿè‡ªåŠ¨å‡çº§åˆ†æ´¾ |
| é‡å¼€åˆ†æ´¾ | æ•…éšœå…³é—­åé‡æ–°æ‰“å¼€ï¼ŒæŒ‰ç…§ä¹‹å‰çš„è®¾ç½®é‡æ–°åˆ†æ´¾ |

<Note>
ç³»ç»Ÿä½¿ç”¨ [Golang æ¨¡æ¿è¯­æ³•](https://pkg.go.dev/html/template@go1.18.1) è§£ææ•°æ®ï¼Œæ”¯æŒé€»è¾‘åˆ¤æ–­ã€å¾ªç¯ã€pipeline åŠå¸¸ç”¨å‡½æ•°ã€‚æ›´å¤šå‡½æ•°è¯·å‚è€ƒ [sprig å‡½æ•°åº“](https://github.com/flashcatcloud/sprig/tree/flashcat)ã€‚
</Note>

## é…ç½®æ¨¡æ¿

<Steps>
<Step title="åˆ›å»ºè‡ªå®šä¹‰æ¨¡æ¿">
è¿›å…¥ **æ¨¡æ¿ç®¡ç†** é¡µé¢ï¼Œç‚¹å‡» **åˆ›å»ºè‡ªå®šä¹‰æ¨¡æ¿** æˆ– **å¤åˆ¶é»˜è®¤æ¨¡æ¿**
</Step>
<Step title="ç¼–è¾‘æ¨¡æ¿å†…å®¹">
æŒ‰é€šçŸ¥æ¸ é“ç¼–è¾‘å¯¹åº”å†…å®¹ï¼Œå¯å¼•ç”¨ä¸‹æ–¹å˜é‡åˆ—è¡¨ä¸­çš„å­—æ®µ
</Step>
<Step title="ä¿å­˜æ¨¡æ¿">
ç‚¹å‡» **ä¿å­˜** å®Œæˆåˆ›å»º
</Step>
</Steps>

### åº”ç”¨æ¨¡æ¿

<Steps>
<Step title="è¿›å…¥åˆ†æ´¾ç­–ç•¥">
å‰å¾€ **åä½œç©ºé—´** â†’ **åˆ†æ´¾ç­–ç•¥**ï¼Œç‚¹å‡» **ç¼–è¾‘**
</Step>
<Step title="é€‰æ‹©æ¨¡æ¿">
åœ¨ç­–ç•¥é…ç½®ä¸­é€‰æ‹© **æŒ‰ç…§å“ªä¸ªæ¨¡æ¿** è¿›è¡Œé€šçŸ¥
</Step>
<Step title="ä¿å­˜é…ç½®">
ç‚¹å‡» **ä¿å­˜** å®Œæˆé…ç½®ã€‚è¯¦è§ [é…ç½®åˆ†æ´¾ç­–ç•¥](/zh/on-call/channel/escalation-rule)
</Step>
</Steps>

## å˜é‡å¼•ç”¨

### å¼•ç”¨ç¤ºä¾‹

```go
// å¼•ç”¨æ•…éšœæ ‡é¢˜
{{.Title}}

// å¼•ç”¨å‘èµ·äººåç§°
{{.Creator.PersonName}}

// å¼•ç”¨ resource æ ‡ç­¾å€¼
{{.Labels.resource}}

// å¼•ç”¨å¸¦ "." çš„æ ‡ç­¾ï¼ˆå¦‚ "A.B"ï¼‰
{{index .Labels "A.B"}}
```

### Incident å˜é‡

æ•…éšœå¯¹è±¡çš„å®Œæ•´å˜é‡åˆ—è¡¨ï¼š

| å­—æ®µ | ç±»å‹ | å¿…å« | è¯´æ˜ |
| :--- | :--- | :---: | :--- |
| ID | string | âœ“ | æ•…éšœ ID |
| `Title` | string | âœ“ | æ•…éšœæ ‡é¢˜ |
| `Description` | string | âœ“ | æ•…éšœæè¿°ï¼Œå¯èƒ½ä¸ºç©º |
| DetailUrl | string | âœ“ | æ•…éšœè¯¦æƒ…é¡µåœ°å€ |
| Num | string | âœ“ | æ•…éšœçŸ­æ ‡è¯†ï¼Œä»…ç”¨äºæ–¹ä¾¿è‚‰çœ¼è¯†åˆ« |
| `IncidentSeverity` | string | âœ“ | ä¸¥é‡ç¨‹åº¦ï¼šCritical / Warning / Info |
| IncidentStatus | string | âœ“ | æ•…éšœçŠ¶æ€ï¼šCritical / Warning / Info / Ok |
| `Progress` | string | âœ“ | å¤„ç†è¿›åº¦ï¼šTriggered / Processing / Closed |
| `StartTime` | int64 | âœ“ | è§¦å‘æ—¶é—´ï¼ŒUnix ç§’æ—¶é—´æˆ³ |
| LastTime | int64 | | æœ€æ–°äº‹ä»¶æ—¶é—´ï¼ŒUnix ç§’æ—¶é—´æˆ³ |
| EndTime | int64 | | æ¢å¤æ—¶é—´ï¼ŒUnix ç§’æ—¶é—´æˆ³ |
| SnoozedBefore | int64 | | æš‚ç¼“æˆªæ­¢æ—¶é—´ï¼ŒUnix ç§’æ—¶é—´æˆ³ |
| AckTime | int64 | | é¦–æ¬¡è®¤é¢†æ—¶é—´ï¼ŒUnix ç§’æ—¶é—´æˆ³ |
| CloseTime | int64 | | å…³é—­æ—¶é—´ï¼ŒUnix ç§’æ—¶é—´æˆ³ |
| Creator | Person | | å‘èµ·äººä¿¡æ¯ï¼Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆæ—¶ä¸å­˜åœ¨ |
| Closer | Person | | å…³é—­äººä¿¡æ¯ï¼Œæ•…éšœè‡ªåŠ¨æ¢å¤æ—¶ä¸å­˜åœ¨ |
| AssignedTo | Assignment | | åˆ†æ´¾é…ç½® |
| Responders | []Responder | | å¤„ç†äººåˆ—è¡¨ |
| ChannelID | int64 | | åä½œç©ºé—´ ID |
| ChannelName | string | | åä½œç©ºé—´åç§° |
| GroupMethod | string | | èšåˆæ–¹å¼ï¼šnï¼ˆä¸èšåˆï¼‰/ pï¼ˆæŒ‰è§„åˆ™ï¼‰/ iï¼ˆæ™ºèƒ½ï¼‰ |
| `Labels` | map | | æ ‡ç­¾ KVï¼ŒKey å’Œ Value å‡ä¸ºå­—ç¬¦ä¸² |
| AlertCnt | int64 | âœ“ | å…³è”å‘Šè­¦ä¸ªæ•° |
| Alerts | []Alert | | å…³è”å‘Šè­¦è¯¦æƒ… |
| FireType | string | | é€šçŸ¥ç±»å‹ï¼šfireï¼ˆé€šçŸ¥ï¼‰/ refireï¼ˆå¾ªç¯é€šçŸ¥ï¼‰ |
| IsFlapping | bool | | æ˜¯å¦å¤„äºæŠ–åŠ¨çŠ¶æ€ |
| Impact | string | | æ•…éšœå½±å“ï¼Œå…³é—­åå¡«å†™ |
| RootCause | string | | æ•…éšœæ ¹å› ï¼Œå…³é—­åå¡«å†™ |
| Resolution | string | | è§£å†³åŠæ³•ï¼Œå…³é—­åå¡«å†™ |

### å…³è”å¯¹è±¡

<AccordionGroup>
<Accordion title="Person - äººå‘˜ä¿¡æ¯">
| å­—æ®µ | ç±»å‹ | å¿…å« | è¯´æ˜ |
| :--- | :--- | :---: | :--- |
| person_id | int64 | âœ“ | äººå‘˜ ID |
| person_name | string | âœ“ | äººå‘˜åç§° |
| email | string | âœ“ | é‚®ä»¶åœ°å€ |
</Accordion>

<Accordion title="Assignment - åˆ†æ´¾é…ç½®">
| å­—æ®µ | ç±»å‹ | å¿…å« | è¯´æ˜ |
| :--- | :--- | :---: | :--- |
| PersonIDs | []string | | äººå‘˜ ID åˆ—è¡¨ï¼Œä»…å½“æŒ‰äººå‘˜åˆ†æ´¾æ—¶å­˜åœ¨ |
| EscalateRuleID | string | | åˆ†æ´¾ç­–ç•¥ ID |
| EscalateRuleName | string | | åˆ†æ´¾ç­–ç•¥åç§° |
| LayerIdx | string | | åˆ†æ´¾ç¯èŠ‚ï¼Œä» 0 å¼€å§‹ |
| Type | string | âœ“ | åˆ†æ´¾ç±»å‹ï¼šassign / reassign / escalate / reopen |
</Accordion>

<Accordion title="Responder - å¤„ç†äºº">
| å­—æ®µ | ç±»å‹ | å¿…å« | è¯´æ˜ |
| :--- | :--- | :---: | :--- |
| PersonID | int64 | âœ“ | äººå‘˜ ID |
| PersonName | string | âœ“ | äººå‘˜åç§° |
| Email | string | âœ“ | é‚®ä»¶åœ°å€ |
| AssignedAt | int64 | âœ“ | åˆ†æ´¾æ—¶é—´ï¼ŒUnix ç§’æ—¶é—´æˆ³ |
| AcknowledgedAt | int64 | | è®¤é¢†æ—¶é—´ï¼ŒUnix ç§’æ—¶é—´æˆ³ |
</Accordion>

<Accordion title="Alert - å‘Šè­¦è¯¦æƒ…">
| å­—æ®µ | ç±»å‹ | å¿…å« | è¯´æ˜ |
| :--- | :--- | :---: | :--- |
| Title | string | âœ“ | å‘Šè­¦æ ‡é¢˜ |
| Description | string | âœ“ | å‘Šè­¦æè¿°ï¼Œå¯èƒ½ä¸ºç©º |
| AlertSeverity | string | âœ“ | ä¸¥é‡ç¨‹åº¦ï¼šCritical / Warning / Info |
| AlertStatus | string | âœ“ | å‘Šè­¦çŠ¶æ€ï¼šCritical / Warning / Info / Ok |
| Progress | string | âœ“ | å¤„ç†è¿›åº¦ï¼šTriggered / Processing / Closed |
| StartTime | int64 | âœ“ | è§¦å‘æ—¶é—´ï¼ŒUnix ç§’æ—¶é—´æˆ³ |
| EndTime | int64 | | æ¢å¤æ—¶é—´ï¼ŒUnix ç§’æ—¶é—´æˆ³ |
| CloseTime | int64 | | å…³é—­æ—¶é—´ï¼ŒUnix ç§’æ—¶é—´æˆ³ |
| Labels | map | | æ ‡ç­¾ KV |
</Accordion>
</AccordionGroup>

## å¸¸è§é—®é¢˜

<AccordionGroup>
<Accordion title="å¦‚ä½•çŸ¥é“ Labels æœ‰å“ªäº›æ ‡ç­¾ï¼Ÿ">
- æ‰‹åŠ¨åˆ›å»ºçš„æ•…éšœæ²¡æœ‰æ ‡ç­¾
- è‡ªåŠ¨åˆ›å»ºçš„æ•…éšœå­˜åœ¨æ ‡ç­¾ï¼Œä¸åˆå…¥çš„ç¬¬ä¸€æ¡å‘Šè­¦çš„æ ‡ç­¾ç›¸åŒ

å‰å¾€ **æ•…éšœåˆ—è¡¨** â†’ æŸ¥çœ‹æ•…éšœè¯¦æƒ…ï¼Œå¯ä»¥çœ‹åˆ°å…¨éƒ¨æ ‡ç­¾ä¿¡æ¯ã€‚
</Accordion>

<Accordion title="é…ç½®äº†è‡ªå®šä¹‰æ¨¡æ¿ï¼Œå®é™…å´ä½¿ç”¨äº†é»˜è®¤æ¨¡æ¿ï¼Ÿ">
åˆ›å»ºè‡ªå®šä¹‰æ¨¡æ¿æ—¶ï¼Œç³»ç»Ÿä½¿ç”¨ mock æ•°æ®æ£€æŸ¥è¯­æ³•ã€‚mock æ•°æ®è¦†ç›–åœºæ™¯æœ‰é™ï¼Œå®é™…è¿è¡Œæ—¶å¯èƒ½æ¸²æŸ“å¤±è´¥ï¼Œç³»ç»Ÿå°†ä½¿ç”¨é»˜è®¤æ¨¡æ¿å…œåº•ã€‚

<Tip>
å»ºè®®åœ¨å¼•ç”¨å˜é‡å‰å…ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨ï¼š

```go
// âŒ é”™è¯¯ï¼šç›´æ¥è¯»å–æ ‡ç­¾
{{.Labels.resource}}

// âœ… æ¨èï¼šå…ˆåˆ¤æ–­å†è¯»å–
{{if .Labels.resource}}{{.Labels.resource}}{{end}}
```
</Tip>
</Accordion>

<Accordion title="æ•…éšœæ ‡é¢˜å«æœ‰å­—ç¬¦è½¬ä¹‰ï¼ˆå¦‚ &gt;ï¼‰ï¼Ÿ">
ä½¿ç”¨ `toHtml` å‡½æ•°å¤„ç†ï¼š

```go
// è½¬ä¹‰ HTML å­—ç¬¦
{{toHtml .Title}}

// ä½¿ç”¨ç¬¬ä¸€ä¸ªä¸ä¸ºç©ºçš„å€¼æ¸²æŸ“
{{toHtml .Title .TitleEnglish}}
```
</Accordion>

<Accordion title="å¦‚ä½•è½¬æ¢æ—¶é—´æ ¼å¼ï¼Ÿ">
```go
// date å‡½æ•°ï¼šå°†æ—¶é—´æˆ³è½¬æ¢ä¸ºå¯è¯»æ ¼å¼
{{date "2006-01-02 15:04:05" .StartTime}}

// ago å‡½æ•°ï¼šå°†æ—¶é—´å·®è½¬æ¢ä¸ºå¯è¯»æ ¼å¼ï¼ˆå¦‚ "5 åˆ†é’Ÿå‰"ï¼‰
{{ago .StartTime}}
```
</Accordion>

<Accordion title="å¦‚ä½•åœ¨ for å¾ªç¯å†…éƒ¨å¼•ç”¨å¤–éƒ¨å˜é‡ï¼Ÿ">
åœ¨å¤–éƒ¨å˜é‡å‰å¢åŠ  `$`ï¼š

```go
{{range .Responders}}
  {{if eq $.Progress "Triggered"}}
    ã€å¾…å¤„ç†ã€‘{{.Email}}
  {{end}}
{{end}}
```
</Accordion>

<Accordion title="å¦‚ä½•æå–å¸¦ . çš„å­—æ®µå€¼ï¼ˆå¦‚ obj.instanceï¼‰ï¼Ÿ">
ä½¿ç”¨ `index` å‡½æ•°ï¼š

```go
{{index .Labels "obj.instance"}}
```
</Accordion>

<Accordion title="å¦‚ä½•æå–å…³è”å‘Šè­¦ä¸­çš„ label å¹¶å»é‡ï¼Ÿ">
```go
// alertLabelsï¼šå¾—åˆ°å»é‡åçš„æ•°ç»„
{{alertLabels . "resource"}}

// joinAlertLabelsï¼šå»é‡åæŒ‰åˆ†éš”ç¬¦æ‹¼æ¥ä¸ºå­—ç¬¦ä¸²
{{joinAlertLabels . "resource" ", "}}
```
</Accordion>

<Accordion title="å¦‚ä½•éå†å¹¶æ‰“å° Labelsï¼Ÿ">
```go
// å®Œæ•´éå†
{{range $k, $v := .Labels}}
  {{$k}} : {{toHtml $v}}
{{end}}

// æ’é™¤å•ä¸ª label
{{range $k, $v := .Labels}}
  {{if ne $k "resource"}}
    {{$k}} : {{toHtml $v}}
  {{end}}
{{end}}

// æ’é™¤å¤šä¸ª labels
{{range $k, $v := .Labels}}
  {{if not (in $k "resource" "body_text")}}
    {{$k}} : {{toHtml $v}}
  {{end}}
{{end}}
```
</Accordion>

<Accordion title="å¦‚ä½•ä» JSON å­—æ®µä¸­æå–ä¿¡æ¯ï¼Ÿ">
ä½¿ç”¨ `jsonGet` å‡½æ•°ä»åˆæ³• JSON ä¸­æŒ‰ path æå–å€¼ã€‚è¯­æ³•å‚è€ƒ [gjson.dev](https://gjson.dev/)ã€‚

```go
// æå– rule_note æ ‡ç­¾ä¸­çš„ detail_url å­—æ®µ
{{jsonGet .Labels.rule_note "detail_url"}}

// æå– JSON æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ çš„ name å­—æ®µ
{{jsonGet .Labels.slice "0.name"}}

// éå†æ•°ç»„ï¼ŒåŒ¹é… userId==7777 çš„ instanceId å­—æ®µ
{{jsonGet .Labels.rule_note "#(userId==7777)#.instanceId"}}
```
</Accordion>

<Accordion title="å¦‚ä½•è·å–å›¾ç‰‡ URLï¼Ÿ">
**imageSrcToURL**ï¼šå°† image_key æˆ– URL è½¬æ¢ä¸ºå¯è®¿é—®åœ°å€ï¼ˆé’‰é’‰/Slack App ä½¿ç”¨ï¼‰

```go
{{ $root := . }}
{{ range $i, $v := .Images }}
  {{ $imageURL := imageSrcToURL $root $v.Src }}
  {{ if $imageURL }}![]({{$imageURL}}){{ end }}
{{ end }}
```

**transferImage**ï¼šä¸Šä¼ å›¾ç‰‡åˆ°ç¬¬ä¸‰æ–¹å¹³å°ï¼ˆé£ä¹¦/Lark App ä½¿ç”¨ï¼‰

```go
{{ $root := . }}
{{ range $i, $v := .Images }}
  {{ $transferURL := transferImage $root $v.Src }}
  {{ if $transferURL }}![]({{$transferURL}}){{ end }}
{{ end }}
```

<Note>
å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡ 10 MBï¼Œæ”¯æŒ JPGã€PNGã€WEBPã€GIFã€BMP ç­‰æ ¼å¼ã€‚
</Note>
</Accordion>

<Accordion title="å¦‚ä½•ä½¿ç”¨é€»è¾‘è¿ç®—ï¼Ÿ">
| å‡½æ•° | è¯´æ˜ | ç¤ºä¾‹ |
| :--- | :--- | :--- |
| `and` | é€»è¾‘ä¸ | `{{if and (eq .A "x") (eq .B "y")}}` |
| `or` | é€»è¾‘æˆ– | `{{if or (eq .A "x") (eq .A "y")}}` |
| `not` | é€»è¾‘é | `{{if not (eq .A "x")}}` |
| `eq` | ç­‰äº | `{{if eq .A "x"}}` |
| `ne` | ä¸ç­‰äº | `{{if ne .A "x"}}` |
| `gt` / `ge` | å¤§äº / å¤§äºç­‰äº | `{{if gt .AlertCnt 1}}` |
| `lt` / `le` | å°äº / å°äºç­‰äº | `{{if lt .AlertCnt 10}}` |
</Accordion>

<Accordion title="å¦‚ä½•æŸ¥é˜…æ›´å¤šå‡½æ•°ï¼Ÿ">
- å‡½æ•°åˆ—è¡¨ï¼š[functions.go](https://github.com/flashcatcloud/sprig/blob/master/functions.go#L97)
- ä½¿ç”¨ç¤ºä¾‹ï¼šæŸ¥çœ‹å¯¹åº”çš„ `_test.go` æ–‡ä»¶ï¼Œå¦‚ [date_test.go](https://github.com/flashcatcloud/sprig/blob/master/date_test.go)
</Accordion>
</AccordionGroup>

## æ¸ é“æ¨¡æ¿

ä¸åŒé€šçŸ¥æ¸ é“æ”¯æŒçš„æ¨¡æ¿æ ¼å¼å’Œé™åˆ¶ä¸åŒã€‚

<Tabs>
<Tab title="é£ä¹¦åº”ç”¨">
éœ€é¢„å…ˆé…ç½® [é£ä¹¦é›†æˆ](/zh/on-call/integration/instant-messaging/lark)ã€‚æ”¯æŒæ¶ˆæ¯å¡ç‰‡æ ¼å¼ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ é™¤å› æ ‡ç­¾ä¸å­˜åœ¨å¯¼è‡´çš„æ¸²æŸ“ç©ºè¡Œã€‚

**é»˜è®¤æ¨¡æ¿**ï¼ˆæ¸²æŸ“å…¨éƒ¨æ ‡ç­¾ï¼‰ï¼š

```go
{{if .Labels.body_text}}{{.Labels.body_text}}{{else if .Description}}{{.Description}}{{end}}
{{if .Labels.resource}}**resource** : {{(joinAlertLabels . "resource" ", ")}}{{end}}
{{range $k, $v := .Labels}}
{{if not (in $k "resource" "body_text" "body_text_with_table")}}**{{$k}}** : {{$v}}{{end}}{{end}}
{{ $root := . }}
{{ range $i, $v := .Images }}
  {{ $transferURL := transferImage $root $v.Src }}
  {{ if $transferURL }}![]({{$transferURL}}){{ end }}
{{ end }}
```

<Frame caption="é£ä¹¦åº”ç”¨é€šçŸ¥æ•ˆæœ">
<img src="https://download.flashcat.cloud/flashduty/changelog/20230720/feishu_app_render.png" alt="é£ä¹¦åº”ç”¨é€šçŸ¥" />
</Frame>

**ç²¾ç®€æ¨¡æ¿**ï¼ˆä»…å±•ç¤ºå…³é”®æ ‡ç­¾ï¼‰ï¼š

```go
{{if (index .Labels "resource")}}resourceï¼š{{toHtml (joinAlertLabels . "resource" ", ")}}{{end}}
{{if (index .Labels "check")}}checkï¼š{{toHtml (index .Labels "check")}}{{end}}
{{if (index .Labels "metric")}}metricï¼š{{index .Labels "metric"}}{{end}}
{{if (index .Labels "trigger_value")}}trigger_valueï¼š{{index .Labels "trigger_value"}}{{end}}
{{if (index .Labels "region")}}regionï¼š{{index .Labels "region"}}{{end}}
{{if (index .Labels "cluster")}}clusterï¼š{{index .Labels "cluster"}}{{end}}
{{if (index .Labels "service")}}serviceï¼š{{index .Labels "service"}}{{end}}
{{if (index .Labels "env")}}envï¼š{{index .Labels "env"}}{{end}}
```
</Tab>

<Tab title="é’‰é’‰åº”ç”¨">
éœ€é¢„å…ˆé…ç½® [é’‰é’‰é›†æˆ](/zh/on-call/integration/instant-messaging/dingtalk)ã€‚æ”¯æŒæ¶ˆæ¯å¡ç‰‡æ ¼å¼ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ é™¤æ¸²æŸ“ç©ºè¡Œã€‚

**é»˜è®¤æ¨¡æ¿**ï¼š

```go
{{if .Description}}**description** :{{toHtml .Labels.body_text .Description}}{{end}}
{{if .Labels.resource}}**resource** : {{toHtml (joinAlertLabels . "resource" ", ")}}{{end}}
{{range $k, $v := .Labels}}
{{if not (in $k "resource" "body_text")}}**{{$k}}** : {{toHtml $v}}{{end}}{{end}}
{{ $root := . }}
{{ range $i, $v := .Images }}
{{ $imageURL := imageSrcToURL $root $v.Src }}
{{ if $imageURL }}![]({{$imageURL}}){{ end }}{{ end }}
```

<Frame caption="é’‰é’‰åº”ç”¨é€šçŸ¥æ•ˆæœ">
<img src="https://download.flashcat.cloud/flashduty/changelog/20230720/dingtalk_app_render.png" alt="é’‰é’‰åº”ç”¨é€šçŸ¥" />
</Frame>
</Tab>

<Tab title="ä¼ä¸šå¾®ä¿¡åº”ç”¨">
éœ€é¢„å…ˆé…ç½® [ä¼ä¸šå¾®ä¿¡é›†æˆ](/zh/on-call/integration/instant-messaging/wecom)ã€‚æ”¯æŒæ¶ˆæ¯å¡ç‰‡æ ¼å¼ã€‚

<Warning>
ä¼ä¸šå¾®ä¿¡é™åˆ¶å¡ç‰‡é•¿åº¦ï¼Œæ¨¡æ¿æ¸²æŸ“åŒºåŸŸæœ€å¤š **8 è¡Œ**ï¼Œè¶…å‡ºéƒ¨åˆ†å°†è¢«éšè—ã€‚
</Warning>

**é»˜è®¤æ¨¡æ¿**ï¼š

```go
{{if (index .Labels "resource")}}resourceï¼š{{toHtml (joinAlertLabels . "resource" ", ")}}{{end}}
{{if (index .Labels "metric")}}metricï¼š{{index .Labels "metric"}}{{end}}
{{if (index .Labels "trigger_value")}}trigger_valueï¼š{{index .Labels "trigger_value"}}{{end}}
{{if (index .Labels "region")}}regionï¼š{{index .Labels "region"}}{{end}}
{{if (index .Labels "cluster")}}clusterï¼š{{index .Labels "cluster"}}{{end}}
{{if (index .Labels "service")}}serviceï¼š{{index .Labels "service"}}{{end}}
{{if (index .Labels "env")}}envï¼š{{index .Labels "env"}}{{end}}
```

<Frame caption="ä¼ä¸šå¾®ä¿¡åº”ç”¨é€šçŸ¥æ•ˆæœ">
<img src="https://download.flashcat.cloud/flashduty/changelog/20230720/wecom_app_render.png" alt="ä¼ä¸šå¾®ä¿¡åº”ç”¨é€šçŸ¥" />
</Frame>
</Tab>

<Tab title="Slack åº”ç”¨">
éœ€é¢„å…ˆé…ç½® [Slack é›†æˆ](/zh/on-call/integration/instant-messaging/slack)ã€‚æ¶ˆæ¯æœ€å¤§é•¿åº¦çº¦ 15000 å­—ç¬¦ï¼Œè¶…å‡ºåæˆªæ–­ã€‚

<Tip>
å±•ç¤ºå›¾ç‰‡æ—¶ï¼Œè¯·ç”¨ `---` æŠŠå›¾ç‰‡å’Œå…¶ä»–å†…å®¹åˆ†å‰²å¼€æ¥ï¼Œæ ¼å¼ä»¥ `![` å¼€å¤´ã€‚
</Tip>

**é»˜è®¤æ¨¡æ¿**ï¼š

```go
{{if .Labels.body_text}}{{.Labels.body_text}}{{else if .Description}}{{.Description}}{{end}}
{{if .Labels.resource}}*resource* : {{(joinAlertLabels . "resource" ", ")}}{{end}}
{{range $k, $v := .Labels}}
{{if not (in $k "resource" "body_text" "body_text_with_table")}}*{{$k}}* : {{$v}}{{end}}{{end}}
{{ $root := . }}
{{ range $i, $v := .Images }}
 {{ $imageURL := imageSrcToURL $root $v.Src }}
 {{ if $imageURL }}
  ---
  ![{{$v.Alt}}]({{$imageURL}})
 {{ end }}
{{ end }}
```

<Frame caption="Slack åº”ç”¨é€šçŸ¥æ•ˆæœ">
<img src="https://download.flashcat.cloud/flashduty/integration/slack/slack_app_message.png" alt="Slack åº”ç”¨é€šçŸ¥" />
</Frame>
</Tab>

<Tab title="Microsoft Teams">
éœ€é¢„å…ˆé…ç½® [Teams é›†æˆ](/zh/on-call/integration/instant-messaging/microsoft-teams)ã€‚æ¶ˆæ¯æœ€å¤§çº¦ 28KBï¼Œè¶…å‡ºåæŠ¥é”™ã€‚

**é»˜è®¤æ¨¡æ¿**ï¼š

```go
{{if .Description}}**description** :{{toHtml .Labels.body_text .Description}}{{end}}
{{if .Labels.resource}}**resource** : {{toHtml (joinAlertLabels . "resource" ", ")}}{{end}}
{{range $k, $v := .Labels}}
{{if not (in $k "resource" "body_text" "body_text_with_table")}}**{{$k}}** : {{toHtml $v}}{{end}}{{end}}
```

<Frame caption="Teams åº”ç”¨é€šçŸ¥æ•ˆæœ">
<img src="https://download.flashcat.cloud/flashduty/integration/microsoft-teams/teams_app_message.png" alt="Teams åº”ç”¨é€šçŸ¥" />
</Frame>
</Tab>
</Tabs>

## æœºå™¨äººæ¨¡æ¿

ç¾¤èŠæœºå™¨äººæ”¯æŒçš„æ¨¡æ¿æ ¼å¼ã€‚

<Tabs>
<Tab title="é£ä¹¦æœºå™¨äºº">
æ”¯æŒæ¶ˆæ¯å¡ç‰‡ã€å¯Œæ–‡æœ¬å’Œæ™®é€šæ–‡æœ¬ä¸‰ç§æ ¼å¼ã€‚æ¶ˆæ¯æœ€å¤§ 4000 å­—èŠ‚ï¼Œè¶…å‡ºåæˆªæ–­ã€‚

<AccordionGroup>
<Accordion title="æ¶ˆæ¯å¡ç‰‡ï¼ˆmsg_type: interactiveï¼‰">
```json
{
  "msg_type": "interactive",
  "card": {
    "config": {
      "wide_screen_mode": true,
      "enable_forward": true
    },
    "header": {
      "template": "{{if eq .IncidentSeverity \"Critical\"}}red{{else if eq .IncidentSeverity \"Warning\"}}orange{{else}}yellow{{end}}",
      "title": {
        "content": "{{fireReason .}}INC #{{.Num}} {{toHtml .Title}}",
        "tag": "plain_text"
      }
    },
    "elements": [{
      "tag": "div",
      "fields": [{
        "text": {
          "tag": "lark_md",
          "content": "**ğŸ¢ åä½œç©ºé—´:**{{.ChannelName}}"
        }
      },
      {
        "text": {
          "tag": "lark_md",
          "content": "**â° è§¦å‘æ—¶é—´:**{{date \"2006-01-02 15:04:05\" .StartTime}}"
        }
      }]
    },
    {
      "tag": "action",
      "actions": [{
        "tag": "button",
        "text": { "tag": "plain_text", "content": "æ•…éšœè¯¦æƒ…" },
        "type": "primary",
        "url": "{{.DetailUrl}}"
      },
      {
        "tag": "button",
        "text": { "tag": "plain_text", "content": "è®¤é¢†" },
        "type": "primary",
        "url": "{{.DetailUrl}}?ack=1"
      }]
    }]
  }
}
```
</Accordion>

<Accordion title="å¯Œæ–‡æœ¬ï¼ˆmsg_type: postï¼‰">
```json
{
  "msg_type": "post",
  "post": {
    "zh_cn": {
      "title": "{{if eq .IncidentSeverity \"Critical\"}}ğŸ”´{{else if eq .IncidentSeverity \"Warning\"}}âš ï¸{{else}}â„¹ï¸{{end}} {{fireReason .}}INC #{{.Num}} {{toHtml .Title}}",
      "content": [
        [{"tag": "text", "text": "ğŸ¢ "}, {"tag": "text", "text": "åä½œç©ºé—´ï¼š", "style": ["bold"]}, {"tag": "text", "text": "{{.ChannelName}}"}],
        [{"tag": "text", "text": "â° "}, {"tag": "text", "text": "è§¦å‘æ—¶é—´ï¼š", "style": ["bold"]}, {"tag": "text", "text": "{{date \"2006-01-02 15:04:05\" .StartTime}}"}],
        [{"tag": "a", "href": "{{.DetailUrl}}", "text": "æ•…éšœè¯¦æƒ…"}, {"tag": "text", "text": "  "}, {"tag": "a", "href": "{{.DetailUrl}}?ack=1", "text": "è®¤é¢†"}]
      ]
    }
  }
}
```
</Accordion>

<Accordion title="æ™®é€šæ–‡æœ¬">
```go
{{fireReason .}}INC #{{.Num}} {{toHtml .Title}}
-----
åä½œç©ºé—´ï¼š{{if .ChannelName}}{{.ChannelName}}{{else}}æ— {{end}}
ä¸¥é‡ç¨‹åº¦ï¼š{{.IncidentSeverity}}
è§¦å‘æ—¶é—´ï¼š{{date "2006-01-02 15:04:05" .StartTime}}
æŒç»­æ—¶é•¿ï¼š{{ago .StartTime}}
<br />è¯¦æƒ…ï¼š{{.DetailUrl}}
```
</Accordion>
</AccordionGroup>
</Tab>

<Tab title="é’‰é’‰æœºå™¨äºº">
ä»…æ”¯æŒ Markdown æ¶ˆæ¯ï¼ˆ[è¯­æ³•é™åˆ¶](https://open.dingtalk.com/document/robots/custom-robot-access#title-7ur-3ok-s1a)ï¼‰ã€‚æ¶ˆæ¯æœ€å¤§ 4000 å­—èŠ‚ã€‚

<Note>
å¦‚æœæ–‡æœ¬åŒ…å« `<br />`ï¼Œæ¸²æŸ“æ—¶ä¼šå…ˆåˆ é™¤ç©ºè¡Œï¼Œå†æ›¿æ¢ä¸ºæ¢è¡Œç¬¦ã€‚
</Note>

**é»˜è®¤æ¨¡æ¿**ï¼š

```go
{{fireReason .}}INC [#{{.Num}}]({{.DetailUrl}}) {{toHtml .Title}}

---
- åä½œç©ºé—´ï¼š{{if .ChannelName}}{{.ChannelName}}{{else}}æ— {{end}}
- ä¸¥é‡ç¨‹åº¦ï¼š{{$s := colorSeverity .IncidentSeverity}}{{toHtml $s}}
- è§¦å‘æ—¶é—´ï¼š{{date "2006-01-02 15:04:05" .StartTime}}
- æŒç»­æ—¶é•¿ï¼š{{ago .StartTime}}{{if gt .AlertCnt 1}}
- èšåˆå‘Šè­¦ï¼š{{.AlertCnt}}æ¡{{end}}{{if .Labels.resource}}
- å‘Šè­¦å¯¹è±¡ï¼š{{toHtml (joinAlertLabels . "resource" ", ")}}{{end}}
---
<br />[è¯¦æƒ…]({{.DetailUrl}})|[è®¤é¢†]({{.DetailUrl}}?ack=1)
```
</Tab>

<Tab title="ä¼ä¸šå¾®ä¿¡æœºå™¨äºº">
ä»…æ”¯æŒ Markdown æ¶ˆæ¯ï¼ˆ[è¯­æ³•é™åˆ¶](https://developer.work.weixin.qq.com/document/path/91770#markdown%E7%B1%BB%E5%9E%8B)ï¼‰ã€‚æ¶ˆæ¯æœ€å¤§ 4000 å­—èŠ‚ã€‚

**é»˜è®¤æ¨¡æ¿**ï¼š

```go
{{fireReason .}}**INC [#{{.Num}}]({{.DetailUrl}}) {{toHtml .Title}}**
> åä½œç©ºé—´ï¼š<font color="warning">{{if .ChannelName}}{{.ChannelName}}{{else}}æ— {{end}}</font>
> ä¸¥é‡ç¨‹åº¦ï¼š<font color="warning">{{.IncidentSeverity}}</font>
> è§¦å‘æ—¶é—´ï¼š{{date "2006-01-02 15:04:05" .StartTime}}
> æŒç»­æ—¶é•¿ï¼š{{ago .StartTime}}{{if gt .AlertCnt 1}}
> èšåˆå‘Šè­¦ï¼š{{.AlertCnt}}æ¡{{end}}
<br />[è¯¦æƒ…]({{.DetailUrl}})|[è®¤é¢†]({{.DetailUrl}}?ack=1)
```
</Tab>

<Tab title="Slack æœºå™¨äºº">
æ¶ˆæ¯æœ€å¤§çº¦ 15000 å­—ç¬¦ï¼Œè¶…å‡ºåæˆªæ–­ã€‚

**é»˜è®¤æ¨¡æ¿**ï¼š

```go
{{fireReason .}}INC <{{.DetailUrl}}|#{{.Num}}> {{toHtml .Title}}
-----
åä½œç©ºé—´ï¼š{{if .ChannelName}}{{.ChannelName}}{{else}}æ— {{end}}
ä¸¥é‡ç¨‹åº¦ï¼š{{.IncidentSeverity}}
è§¦å‘æ—¶é—´ï¼š{{date "2006-01-02 15:04:05" .StartTime}}
æŒç»­æ—¶é•¿ï¼š{{ago .StartTime}}{{if gt .AlertCnt 1}}
èšåˆå‘Šè­¦ï¼š{{.AlertCnt}}æ¡{{end}}
-----
<br /><{{.DetailUrl}}|è¯¦æƒ…>|<{{.DetailUrl}}?ack=1|è®¤é¢†>
```
</Tab>

<Tab title="Telegram æœºå™¨äºº">
æ¶ˆæ¯æœ€å¤§ 4096 å­—ç¬¦ï¼Œè¶…å‡ºåä¸å‘é€ã€‚éœ€é…ç½®å›½å†…å¯è®¿é—®çš„ Telegram æœåŠ¡åœ°å€ã€‚

**é»˜è®¤æ¨¡æ¿**ï¼š

```go
{{fireReason .}}INC [#{{.Num}}]({{.DetailUrl}}) {{toHtml .Title}}
-----
åä½œç©ºé—´ï¼š{{if .ChannelName}}{{.ChannelName}}{{else}}æ— {{end}}
ä¸¥é‡ç¨‹åº¦ï¼š{{.IncidentSeverity}}
è§¦å‘æ—¶é—´ï¼š{{date "2006-01-02 15:04:05" .StartTime}}
æŒç»­æ—¶é•¿ï¼š{{ago .StartTime}}
<br />[è¯¦æƒ…]({{.DetailUrl}})|[è®¤é¢†]({{.DetailUrl}}?ack=1)
```
</Tab>
</Tabs>

## å…¶ä»–æ¸ é“

<Tabs>
<Tab title="çŸ­ä¿¡">
**é»˜è®¤æ¨¡æ¿**ï¼š

```go
æ‚¨æœ‰æ•…éšœå¾…å¤„ç†ï¼š{{toHtml .Title}}ï¼Œåä½œç©ºé—´ï¼š{{.ChannelName}}ï¼Œç­‰çº§ï¼š{{.IncidentSeverity}}{{if gt .AlertCnt 1}}ï¼Œå…±èšåˆ{{.AlertCnt}}æ¡å‘Šè­¦{{end}}
```
</Tab>

<Tab title="é‚®ä»¶">
æ”¯æŒå®Œæ•´ HTML æ ¼å¼ã€‚é»˜è®¤æ¨¡æ¿æä¾›ä¸“ä¸šçš„é‚®ä»¶æ’ç‰ˆï¼ŒåŒ…å«æ•…éšœæ ‡é¢˜ã€ä¸¥é‡ç¨‹åº¦ã€åä½œç©ºé—´ã€è§¦å‘æ—¶é—´ã€å¤„ç†äººå‘˜ç­‰ä¿¡æ¯ï¼Œä»¥åŠã€Œç«‹å³è®¤é¢†ã€å’Œã€ŒæŸ¥çœ‹è¯¦æƒ…ã€æŒ‰é’®ã€‚

<Frame caption="é‚®ä»¶é€šçŸ¥æ•ˆæœ">
<img src="https://download.flashcat.cloud/flashduty/changelog/20230720/email_render.png" alt="é‚®ä»¶é€šçŸ¥" />
</Frame>
</Tab>
</Tabs>

## å»¶ä¼¸é˜…è¯»

<CardGroup cols={2}>
<Card title="é…ç½®åˆ†æ´¾ç­–ç•¥" icon="route" href="/zh/on-call/channel/escalation-rule">
å®šä¹‰æ•…éšœçš„é€šçŸ¥è§„åˆ™å’Œå‡çº§æœºåˆ¶
</Card>
<Card title="é…ç½®ä¸ªäººåå¥½" icon="user-gear" href="/zh/on-call/configuration/personal-settings">
è‡ªå®šä¹‰é€šçŸ¥æ—¶æ®µå’Œæ¸ é“åå¥½
</Card>
</CardGroup>
