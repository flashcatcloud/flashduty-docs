---
title: "分派策略"
description: "配置告警分派规则，确保故障及时通知到正确的人员"
keywords: ["分派策略", "告警分派", "升级规则", "值班通知", "多级升级"]
---

分派策略决定了故障发生时，系统 **在什么时间**、**通过什么渠道**、**通知给谁**、**超时如何升级**。通过单聊、群聊和多级升级等机制，确保重要故障一定有人响应。

{/*
## 视频介绍

<video
controls
className="w-full aspect-video rounded-xl"
src="https://download.flashcat.cloud/flashduty/video/escalate-rule.mp4"
></video>

*/}

## 配置要素

一条分派策略包含四个核心要素，系统按从上到下的顺序匹配策略，**匹配成功后停止匹配后续策略**。

### 1. 触发条件

决定了哪些故障会触发当前策略。

**生效时间**：控制策略在何时参与匹配。

- **关闭（默认）**：7x24 小时全天候生效
- **开启**：仅在指定时间范围内参与匹配，超出时间的故障将跳过该策略。支持两种方式：
  - **特定时间段**：如仅工作日（周一至周五 9:00-18:00）生效
  - **服务日历**：引用预定义的 [服务日历](/zh/on-call/configuration/service-calendar)，如仅「交易日」生效，自动排除节假日

**故障筛选**：控制策略匹配哪些故障。

- **关闭（默认）**：所有故障均可能命中该策略
- **开启**：根据故障属性精准过滤，支持按 **标题**、**级别**（如仅 Critical）、**标签**（如 `service=payment`）等条件匹配

<Frame caption="分派策略触发条件配置">
  ![触发条件配置](https://docs-cdn.flashcat.cloud/images/png/47b05ed667e69087af793fe0cb23c0b6.png)
</Frame>

### 2. 通知对象

决定了通知发送给谁。

| 对象类型        | 说明            |
| :---------- | :------------ |
| **值班表（推荐）** | 分派给当前正在值班的人员  |
| **团队**      | 分派给整个团队的所有成员  |
| **个人**      | 固定分派给特定人员     |
| **组合模式**    | 您可以同时选择上述多种对象 |

<Tip>
  如需根据告警内容动态路由到负责人（如根据 `owner` 标签自动分派），请参考 [动态分派](/zh/on-call/advanced/dynamic-notifications)。
</Tip>

### 3. 通知方式

决定了通过什么方式触达用户。

<Tabs>
  <Tab title="单聊（触达个人）">
    点对点发送给具体的分派对象，支持电话、短信、邮件、App 推送、IM 私聊（飞书/钉钉/企微）。

    - **遵循个人偏好（推荐）**：通知方式由成员在 [个人中心](/zh/on-call/configuration/personal-settings) 自行配置
    - **遵循统一设置**：强制规定通知方式（如必须发送短信），覆盖成员的个人偏好
  </Tab>
  <Tab title="群聊（触达群组）">
    发送到即时通讯软件的群组中，支持 @ 提到相关人员。

    - **IM 应用群**：支持飞书、钉钉、企业微信群，需先完成 [IM 集成](/zh/on-call/integration/instant-messaging/lark)
    - **群机器人**：支持飞书、钉钉、企业微信等 Webhook 机器人。详见 [通知渠道配置](/zh/on-call/configuration/notifications)
  </Tab>
</Tabs>

### 4. 升级规则

这是确保故障闭环的关键机制。当第一层级的处理人没有响应或处理完成时，系统会自动升级到下一层级。

**升级条件**：

- **超时未认领**：故障触发后 N 分钟无人认领
- **超时未关闭**：故障触发后 N 分钟未解决

**典型场景**：

| 场景      | 升级路径                              |
| :------ | :-------------------------------- |
| 一线 → 二线 | 一线值班（SRE）15 分钟未响应 → 升级给二线研发专家     |
| 主备升级    | 主值班人 10 分钟未响应 → 升级给备值班人           |
| 层层上报    | 技术人员 30 分钟未解决 → 升级给技术主管 → 升级给 CTO |

## 最佳实践

<AccordionGroup>
  <Accordion title="兜底策略" icon="shield">
    建议在列表底部保留一条 **无过滤条件** 的默认策略，分派给 SRE 团队或管理员，防止因过滤规则配置失误导致故障漏单。
  </Accordion>
  <Accordion title="避免过度打扰" icon="bell-slash">
    - 对于 `Info` / `Warning` 级别的低优告警，建议仅发送 IM 消息，不使用电话或短信
    - 使用 **重复通知** 功能时需谨慎，避免产生告警轰炸
  </Accordion>
  <Accordion title="合理拆分空间" icon="layer-group">
    不要试图用一个协作空间管理全公司的所有告警。按功能模块或团队拆分空间，每个空间维护独立且简单的分派策略，是降低维护成本的关键。
  </Accordion>
</AccordionGroup>

## 常见问题

<AccordionGroup>
  <Accordion title="有告警产生，但没有收到通知？" icon="circle-question">
    前往 故障详情 → **时间线**，查看各渠道通知状态是否正常。如有失败信息可参考排查，更多问题可联系技术支持。
  </Accordion>
  <Accordion title="通知方式与个人偏好设置不符？" icon="circle-question">
    Flashduty On-call 单聊通知支持两种模式：「遵循个人偏好」和「遵循统一设定」。仅在「遵循个人偏好」模式下，系统才会按照您的个人设置发送通知。

    前往 协作空间详情 → **分派策略** 查看当前设定。
  </Accordion>
</AccordionGroup>

## 延伸阅读

<CardGroup cols={3}>
  <Card title="配置值班表" icon="calendar" href="/zh/on-call/configuration/schedule">
    设置轮班规则，实现自动分派
  </Card>
  <Card title="配置个人偏好" icon="user-gear" href="/zh/on-call/configuration/personal-settings">
    自定义通知时段和渠道
  </Card>
  <Card title="配置通知模板" icon="file-lines" href="/zh/on-call/configuration/templates">
    自定义通知内容格式
  </Card>
</CardGroup>