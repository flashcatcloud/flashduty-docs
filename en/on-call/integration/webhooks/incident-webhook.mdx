Configure incident Webhook. When specific operations occur on incidents (such as trigger or close), the system makes an HTTP callback to your configured address. The callback content includes the incident's latest key information, allowing integration with your custom tools.

<span id="EventTypes"></span>

## 1. Event Types

The following event types are currently supported; more may be added in the future.

<div className="md-block">

| Event Type | Description |
| :----------: | :--------------- |
| i_new | Create incident (auto or manual) |
| i_assign | Assign incident (auto or manual) |
| i_snooze | Manually snooze incident |
| i_wake | Cancel snooze |
| i_ack | Manually acknowledge incident |
| i_unack | Cancel acknowledgment |
| i_storm | Trigger storm warning |
| i_custom | Trigger custom action |
| i_rslv | Close incident (auto or manual) |
| i_reopen | Reopen incident |
| i_merge | Manually merge incident |
| i_comm | Add comment |
| i_r_title | Update incident title |
| i_r_desc | Update incident description |
| i_r_impact | Update incident impact |
| i_r_rc | Update incident root cause |
| i_r_rsltn | Update incident resolution |
| i_r_severity | Update incident severity |
| i_r_field | Update incident custom field |

</div>

## 2. Push Description

### Request Method

<div className="md-block">

POST, Content-Type:"application/json"

</div>

### Request Payload:

<div className="md-block">

| Field | Type | Required | Description |
| :--------: | :-------------------: | :--: | :--------- |
| event_time | int64 | Yes | Event timestamp in `milliseconds` |
| event_type | string | Yes | Event type, enum values see [Event Types](#EventTypes) |
| event_id | string | Yes | Event ID, `the same event may retry multiple times due to timeout, receiver needs to deduplicate` |
| person | [Person](#Person) | No | Operator, only exists for human actions |
| incident | [Incident](#Incident) | Yes | Incident details |

<span id="Person"></span>
**Person**:
Field|Type|Required|Description
:-:|:-:|:-:|:---
person_id | int64 | Yes | Person ID
person_name | string | Yes | Person name
email | string | Yes | Email address

<span id="Responder"></span>
**Responder**:
Field|Type|Required|Description
:-:|:-:|:-:|:---
person_id | int64 | Yes | Person ID
person_name | string | Yes | Person name
email | string | Yes | Email address
assigned_at | int64 | No | Assignment time
acknowledged_at | int64 | No | Acknowledgment time

<span id="Incident"></span>
**Incident**:

| Field | Type | Required | Description |
| :---------------: | :-----------------: | :--: | :----------------- |
| incident_id | string | Yes | Incident ID |
| title | string | Yes | Incident title |
| description | string | No | Incident description |
| impact | string | No | Incident impact |
| root_cause | string | No | Incident root cause |
| resolution | string | No | Incident resolution |
| incident_severity | string | Yes | Severity, enum: Critical, Warning, Info |
| incident_status | string | Yes | Incident status, enum: Critical, Warning, Info, Ok |
| progress | string | Yes | Progress, enum: Triggered, Processing, Closed |
| created_at | int64 | Yes | Created time |
| updated_at | int64 | Yes | Updated time |
| start_time | int64 | Yes | Trigger time, Unix seconds timestamp |
| last_time | int64 | No | Latest event time, latest event push time in associated alerts, Unix seconds timestamp, default 0 |
| end_time | int64 | No | Recovery time, incident auto-recovers when all associated alerts recover, Unix seconds timestamp, default 0 |
| ack_time | int64 | No | First acknowledgment time, incident can be acknowledged by multiple people, this is the earliest acknowledgment time. Unix seconds timestamp, default 0 |
| close_time | int64 | No | Close time, end_time represents incident recovery time, close_time represents progress close time, incident closes when recovered, closing doesn't affect recovery. Unix seconds timestamp, default 0 |
| snoozed_before | int64 | No | Snooze deadline |
| labels | map[string]string | No | Label KV, both Key and Value are strings. Not present for manual creation, for auto creation it's the labels of the first grouped alert |
| fields | map[string]interface{} | No | Custom field KV, Key is string, Value can be any type depending on field type |
| creator | [Person](#Person) | No | Creator info, only exists for manually created incidents |
| closer | [Person](#Person) | No | Closer info, only exists for manually closed incidents |
| responders | [][Responder](#Responder) | No | Responders list, only exists after incident is assigned. May be empty for i_new event |
| alert_cnt | int64 | No | Associated alert count |
| channel_id | int64 | No | Channel ID, 0 means not belonging to any channel |
| channel_name | string | No | Channel name |
| detail_url | string | Yes | Detail URL |
| group_method | string | No | Grouping method, enum: n: no grouping, p: rule-based grouping, i: intelligent grouping |


</div>

### Request Response

HTTP status code 200 indicates successful push.

### Request Example

```
curl -X POST 'https://example.com/incident/webhook?a=a' \
-H 'Content-Type: application/json' \
-H 'X-Customize-Header-A: a' \
-d '{
    "event_id":"fac0599a2a25529ba2362c0c184b6cfb",
    "event_time":1689335086948,
    "event_type":"i_new",
    "incident":{
        "account_id":74058170041504,
        "account_name":"TouTie Tech",
        "ack_time":0,
        "alert_cnt":0,
        "assigned_to":{
            "assigned_at":1689335086,
            "escalate_rule_id":"64abb8a687e7984845822139",
            "escalate_rule_name":"Default Escalation",
            "id":"NBRbNwDSTSMijKXdLtBU3T",
            "layer_idx":0,
            "type":"assign"
        },
        "channel_id":1840312623504,
        "channel_name":"Reduce Noise",
        "close_time":0,
        "created_at":1689335086,
        "creator":{
            "email":"toutie@flashcat.cloud",
            "person_id":1552048792504,
            "person_name":"TouTie"
        },
        "creator_id":1552048792504,
        "data_source_id":0,
        "dedup_key":"",
        "description":"",
        "detail_url":"http://10.206.0.17:8567/incident/detail/64b1352e376e32c85c56e25b",
        "end_time":0,
        "equals_md5":"",
        "group_method":"n",
        "impact":"",
        "incident_id":"64b1352e376e32c85c56e25b",
        "incident_severity":"Critical",
        "incident_status":"Critical",
        "labels":{
            "check": "cpu idle low"
        },
        "last_time":1689335086,
        "num":"56E25B",
        "progress":"Triggered",
        "resolution":"",
        "responder_ids":[
            1552048792504
        ],
        "responders":[
            {
                "acknowledged_at":0,
                "assigned_at":1689335086,
                "email":"toutie@flashcat.cloud",
                "person_id":1552048792504,
                "person_name":"TouTie"
            }
        ],
        "root_cause":"",
        "snoozed_before":0,
        "start_time":1689335086,
        "title":"ysy028",
        "updated_at":1689335086
    },
    "person":{
        "email":"toutie@flashcat.cloud",
        "person_id":1552048792504,
        "person_name":"TouTie"
    }
}' -v
```

## 3. FAQ

1. **Is there a response timeout?**

   - Service needs to return response within 2 seconds; exceeding 2 seconds is considered a failure

2. **Will pushes continue after failure?**

  Retries for specific network errors, max 1 retries:
    - context deadline exceeded (excluding awaiting headers)
    - i/o timeout
    - eof

3. **How to ensure push order?**

   - Theoretically, events for the same incident are pushed in chronological order, but retries may cause out-of-order delivery
   - Services can filter based on event_time; if a later event has been received, earlier events can be filtered out. Each push carries the latest complete information, so occasional event loss is tolerable

4. **Trusted IP whitelist for push source?**
   - {ip_whitelist}
   - May be updated in the future, please check regularly
